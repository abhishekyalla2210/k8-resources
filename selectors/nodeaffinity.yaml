apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx
spec:
  replicas: 1
  selector: 
    matchLabels:
      apps: nginx
  template:
    metadata:
      labels: 
        apps: nginx
    spec:
    affinity:
      nodeAffinity:
        # hard rule
        requiredDuringSchedulingIgnoredDuringExecution:
          nodeSelectorTerms:
          - matchExpressions:
            - key: topology.kubernetes.io/zone
              operator: In
              values:
              - us-east-1b
            # - key: disktype
            #   operator: In
            #   values:
            #   - ssd
        # soft rule
        preferredDuringSchedulingIgnoredDuringExecution:
        - weight: 100
          preference:
            matchExpressions:
            - key: project
              operator: In
              values:
              - roboshop
        - weight: 10
          preference:
            matchExpressions:
            - key: project
              operator: In
              values:
              - amazon
    containers:
    - name: nginx
      image: nginx
      imagePullPolicy: Always